/* eslint no-console: "off" */
'use strict';
const util = require('./util');
const path = require('path');
const DINFRA_PATH_DEFAULT = `../../dinfra-library/lib/dinfra.js`;
const DCONFIG_PATH_DEFAULT = `../../tirex4-dconfig.json`;
const APPCONFIG_PATH_DEFAULT = `../../tirex4-sconfig.json`;
//
// Yargs Command config
//
exports.handler = function (argv) {
    const sitemapGenerator = require('../lib/sitemapGenerator');
    argv.dinfra = util.resolvePath(argv.dinfra);
    argv.dconfig = util.resolvePath(argv.dconfig);
    argv.appconfig = util.resolvePath(argv.appconfig);
    sitemapGenerator.createSitemap(argv).catch((e) => {
        console.error('An error has occurred during create sitemap');
        console.error(e);
        process.exit(1);
    });
};
exports.command = `${path.basename(__filename, '.js')} [options]`;
exports.describe =
    'Create sitemaps for packages in latest version. Stream up static content for googlebot to crawl. The source of the metadata are the JSON DB files generated by the DB Builder, and the source of the content is the filesystem folder containg the package files. The location of the JSON DB files and the content are taken from the appconfig properties dbPath and contentPath.';
exports.builder = {
    dinfra: {
        describe: 'path to dinfra.js (relative or absolute)',
        demandOption: false,
        default: DINFRA_PATH_DEFAULT
    },
    dconfig: {
        describe: 'path to dconfig file (relative or absolute)',
        demandOption: false,
        default: DCONFIG_PATH_DEFAULT
    },
    appconfig: {
        describe: 'path to the app config file (relative or absolute)',
        demandOption: false,
        default: APPCONFIG_PATH_DEFAULT
    }
};
